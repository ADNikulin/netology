# Микросервисы. Никулин Александр. 
# Домашнее задание к занятию «Микросервисы: подходы»

Вы работаете в крупной компании, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps-специалисту необходимо выдвинуть предложение по организации инфраструктуры для разработки и эксплуатации.

## Задача 1: Обеспечить разработку
<details>
  <summary>Условия</summary>

  Предложите решение для обеспечения процесса разработки: хранение исходного кода, непрерывная интеграция и непрерывная поставка. 
  Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

  Решение должно соответствовать следующим требованиям:
  - облачная система;
  - система контроля версий Git;
  - репозиторий на каждый сервис;
  - запуск сборки по событию из системы контроля версий;
  - запуск сборки по кнопке с указанием параметров;
  - возможность привязать настройки к каждой сборке;
  - возможность создания шаблонов для различных конфигураций сборок;
  - возможность безопасного хранения секретных данных (пароли, ключи доступа);
  - несколько конфигураций для сборки из одного репозитория;
  - кастомные шаги при сборке;
  - собственные докер-образы для сборки проектов;
  - возможность развернуть агентов сборки на собственных серверах;
  - возможность параллельного запуска нескольких сборок;
  - возможность параллельного запуска тестов.

  Обоснуйте свой выбор.
</details>

<details>
  <summary>Решение</summary>

  Выберу по классике наверное: 

  **GitLab CI/CD** — это основной инструмент для хранения исходного кода и обеспечения процессов непрерывной интеграции и непрерывного развёртывания (CI/CD). Он предоставляет мощные возможности для управления проектами, отслеживания задач, интеграции с другими инструментами и обеспечения безопасности кода.

  GitLab предлагает как облачную версию GitLab.com, так и возможность установки на собственные серверы, что даёт гибкость в зависимости от требований компании. 

  Основные компоненты GitLab:

  - GitLab CE: Основной продукт, включающий систему контроля версий GitLab, веб-интерфейс для управления проектами и репозиториями, а также инструменты для непрерывной интеграции и доставки.
  - GitLab Runner: Агент, который выполняет CI/CD-задачи на различных платформах (например, Windows, macOS, Linux).
  - GitLab CI/CD: Платформа для автоматизации процессов сборки, тестирования и развёртывания приложений.
  - GitLab Pages: Сервис для хостинга статических веб-сайтов, блогов и документации.
  - GitLab Omnibus: Пакет для установки GitLab на локальные серверы.
  - GitLab Shell: Интерактивная оболочка для выполнения команд GitLab и управления проектами.
  - GitLab Hub: Облачный хостинг для репозиториев GitLab.
  - GitLab Self-Hosted Runner: Инструмент для выполнения CI/CD-задач на собственном сервере GitLab.
  - GitLab EE: Профессиональная версия GitLab с расширенными возможностями безопасности, мониторинга и управления.
  
  GitLab поддерживает интеграцию с различными инструментами и сервисами, такими как Jira, Confluence, Bitbucket, Jenkins и многими другими, что делает его универсальным решением для команд любого размера и уровня опыта.

  В целом отвечает всем потребносятм выше. 

  Но как говориться не клади яца в одну корзину.... 
  Можно рассмотреть вариант распределенной всей системы в целом. Использовать облачные jira + git + teamcity. 
  Плучаем всё тот же функционал но уже от разных вендоров.

</details>

## Задача 2: Логи
<details>
  <summary>Условия</summary>

  Предложите решение для обеспечения сбора и анализа логов сервисов в микросервисной архитектуре.
  Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

  Решение должно соответствовать следующим требованиям:
  - сбор логов в центральное хранилище со всех хостов, обслуживающих систему;
  - минимальные требования к приложениям, сбор логов из stdout;
  - гарантированная доставка логов до центрального хранилища;
  - обеспечение поиска и фильтрации по записям логов;
  - обеспечение пользовательского интерфейса с возможностью предоставления доступа разработчикам для поиска по записям логов;
  - возможность дать ссылку на сохранённый поиск по записям логов.

  Обоснуйте свой выбор.
</details>

<details>
  <summary>Решение</summary>

  **Filebeat** — Агент для сбора логов
  Filebeat — это легковесный агент, который устанавливается на каждом сервере для сбора логов и их отправки в центральное хранилище.

  - Сбор логов из stdout: Filebeat легко настраивается для чтения логов, отправляемых в stdout. Это минимизирует необходимость изменений в приложениях, так как большинство микросервисов и контейнерных решений (Docker, Kubernetes) записывают логи в stdout/stderr.
  - Надежная доставка логов: Filebeat гарантирует доставку логов благодаря буферизации и поддержке backpressure, что предотвращает потерю данных при временной недоступности центрального хранилища.
  - Легкость агента: Filebeat потребляет минимум ресурсов и может быть легко развернут на любом сервере или контейнере, что делает его идеальным для микросервисных архитектур.

  **Logstash** — Платформа для обработки и агрегации логов
  Logstash — это инструмент для централизованной агрегации логов с возможностью их фильтрации, трансформации и нормализации перед отправкой в хранилище.

  - Гибкость обработки логов: Logstash позволяет настраивать фильтры для нормализации и обогащения данных из логов. Например, можно разделять логи на поля, добавлять метаданные (например, имя хоста, имя сервиса), чтобы упростить анализ.
  - Поддержка различных форматов данных: Logstash может принимать логи в различных форматах, таких как JSON, Syslog и т.д., что упрощает интеграцию с разными сервисами.
  - Интеграция с Filebeat и Elasticsearch: Logstash напрямую принимает данные от Filebeat и передает их в Elasticsearch для индексации, обеспечивая эффективную доставку логов в центральное хранилище.

  **Elasticsearch** — Централизованное хранилище и поисковая система
  Elasticsearch — это распределенная поисковая система и хранилище данных, которое обеспечивает быстрый доступ к большим объемам логов и поддерживает сложные запросы для анализа.

  - Централизованное хранилище логов: Elasticsearch обеспечивает хранение всех логов в одном месте с распределением данных по кластерам, что гарантирует надежность и масштабируемость.
  - Поиск и фильтрация логов: Elasticsearch поддерживает мощные поисковые и фильтровочные запросы на основе Lucene. Это позволяет разработчикам легко находить нужные записи логов по различным критериям (меткам, времени, сообщениям и т.д.).
  - Надежная доставка логов: Elasticsearch обеспечивает надежность хранения данных за счет распределенной архитектуры с репликацией данных.
</details>

## Задача 3: Мониторинг

<details>
  <summary>Условия</summary>

  Предложите решение для обеспечения сбора и анализа состояния хостов и сервисов в микросервисной архитектуре.
  Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

  Решение должно соответствовать следующим требованиям:
  - сбор метрик со всех хостов, обслуживающих систему;
  - сбор метрик состояния ресурсов хостов: CPU, RAM, HDD, Network;
  - сбор метрик потребляемых ресурсов для каждого сервиса: CPU, RAM, HDD, Network;
  - сбор метрик, специфичных для каждого сервиса;
  - пользовательский интерфейс с возможностью делать запросы и агрегировать информацию;
  - пользовательский интерфейс с возможностью настраивать различные панели для отслеживания состояния системы.

  Обоснуйте свой выбор.
</details>

<details>
  <summary>Решение</summary>

  **Grafana** — это инструмент визуализации данных, который поддерживает множество источников информации, включая Loki, Clickhouse, Elasticsearch, Prometheus и другие.
  - Grafana предлагает интуитивно понятный интерфейс для создания дашбордов и панелей, а также коллекцию готовых элементов, которые можно импортировать.
  - Интерфейс Grafana может меняться в зависимости от выбранного источника данных. Например, при использовании базы данных временных рядов InfluxDB интерфейс будет содержать функциональный конструктор запросов данных.
  - Большинство источников данных поддерживают функции фильтрации, трансформации и группировки информации.

  **Victoria Metrics**
  - **Расширенный функционал**. Решение для мониторинга на базе открытого кода с возможностью масштабирования как вертикально, так и горизонтально.
  - **Длительное хранение метрик**. Это позволяет анализировать тенденции и сравнивать данные за разные периоды времени.
  - **Быстрая обработка данных**. Victoria Metrics не требует больших вычислительных ресурсов, что важно при высокой нагрузке на системы. 
  - **Эффективное сжатие данных**. Система обеспечивает до 10-кратное сжатие данных по сравнению с Prometheus, что критично для длительного хранения и оптимизации затрат.
  - **Кластеризация**. Функция позволяет распределить данные между несколькими узлами и обеспечить более высокую доступность. 3
</details>

---

### Как оформить ДЗ?

Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.

---
